---
// Testimonials carousel component
const testimonials = [
  {
    name: "Vytautas Vasiliauskas",
    position: "Technologijų direktorius",
    company: "KAVITA",
    image: "/media/recomendations/rec-kavita.webp",
    quote: "Įdiegus VECTICUM sprendimus, mūsų kasdieniai procesai tapo žymiai efektyvesni. Automatizavus daugelį darbų, galime daugiau dėmesio skirti savo pagrindiniams tikslams – klientų poreikiams ir jų įgyvendinimui. Pastebėjome aiškų laiko ir resursų taupymą, VECTICUM tapo mūsų komandos kasdienių darbų partneriu, padedančiu užtikrinti aukščiausią paslaugų kokybę."
  },
  {
    name: "Georgij Nikonorov",
    position: "HR vadovas",
    company: "YUKON Advanced Optics Worldwide",
    image: "/media/recomendations/yukon-rec.png",
    quote: "Mes nuoširdžiai vertiname Vecticum darbą — platforma padėjo mums sisteminti ir automatizuoti procesus, taip pat ženkliai padidinti mūsų darbo efektyvumą. Džiugina patogumas, apgalvotas funkcionalumas ir operatyvi pagalba. Komanda visada reaguoja į iškylančius klausimus ir greitai išsprendžia bet kokias problemas. Dėkojame Vecticum už bendradarbiavimą ir rūpestį klientais!"
  },
  {
    name: "Skaistė Grėbliauskė",
    position: "Finansų direktorė",
    company: "FREDA",
    image: "/media/recomendations/FREDA-REC.png",
    quote: "Šis sprendimas ženkliai pagerino mūsų įmonės dokumentų valdymo procesus. Sistema veikia patikimai ir yra lengvai pritaikoma augantiems poreikiams. Bendradarbiavimas su Vecticum komanda leidžia efektyviai diegti naujus funkcionalumus ir užtikrinti, kad dokumentų apdorojimas vyktų sklandžiai."
  },
  {
    name: "Erika Grigaliūnaitė",
    position: "Pirkimų vadybininkė",
    company: "GATAS",
    image: "/media/recomendations/GATAS-rec.png",
    quote: "Nesudėtingas programos naudojimas. Palengvėja sąskaitų apskaita, yra galimybė pasitikrinti, ar visos sąskaitos užregistruotos, todėl darbas tampa lengvesnis ir efektyvesnis."
  }
];
---

<section class="py-20 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-white to-gray-50 overflow-hidden">
  <div class="max-w-7xl mx-auto">
    <!-- Section Header -->
    <div class="text-center mb-16">
      <h2 class="text-4xl sm:text-5xl font-bold text-gray-900 mb-4">
        Ką sako mūsų klientai
      </h2>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto">
        Sužinokite, kaip VECTICUM sprendimai padeda įmonėms automatizuoti procesus ir didinti efektyvumą
      </p>
    </div>

    <!-- Carousel Container -->
    <div class="relative max-w-7xl mx-auto">
      <!-- Testimonials Slider -->
      <div class="testimonials-container overflow-hidden px-12 md:px-16">
        <div class="testimonials-track flex transition-transform duration-500 ease-out">
          {testimonials.map((testimonial) => (
            <div class="testimonial-slide flex-shrink-0 w-full px-4">
              <div class="bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 max-w-6xl mx-auto overflow-hidden border-t-4 border-[#C81F6A]">
                <div class="grid md:grid-cols-2 gap-8 p-8 md:p-12 items-center">
                  
                  <!-- Left side - Image with circular cutout -->
                  <div class="relative order-2 md:order-1">
                    <div class="relative w-full aspect-square max-w-md mx-auto">
                      <!-- Circular cutout effect -->
                      <div class="absolute inset-0 rounded-full overflow-hidden shadow-2xl border-4 border-white">
                        <img 
                          src={testimonial.image} 
                          alt={testimonial.company}
                          class="w-full h-full object-cover"
                        />
                        <!-- Gradient overlay -->
                        <div class="absolute inset-0 bg-gradient-to-br from-[#C81F6A]/10 to-[#3C7099]/10"></div>
                      </div>
                      <!-- Decorative circles -->
                      <div class="absolute -top-4 -right-4 w-24 h-24 bg-[#C81F6A]/10 rounded-full blur-2xl"></div>
                      <div class="absolute -bottom-4 -left-4 w-32 h-32 bg-[#3C7099]/10 rounded-full blur-2xl"></div>
                    </div>
                  </div>

                  <!-- Right side - Content -->
                  <div class="order-1 md:order-2">
                    <!-- Quote Icon -->
                    <div class="mb-6">
                      <svg class="w-12 h-12 text-[#C81F6A] opacity-50" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"/>
                      </svg>
                    </div>

                    <!-- Rating Stars -->
                    <div class="flex gap-1 mb-6">
                      {[...Array(5)].map(() => (
                        <svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                        </svg>
                      ))}
                    </div>

                    <!-- Testimonial Text -->
                    <blockquote class="text-gray-700 text-lg leading-relaxed mb-8 italic">
                      "{testimonial.quote}"
                    </blockquote>

                    <!-- Author Info -->
                    <div class="pt-6 border-t border-gray-200">
                      <div class="font-bold text-gray-900 text-lg">{testimonial.name}</div>
                      <div class="text-[#C81F6A] text-sm font-medium">{testimonial.position}</div>
                      <div class="text-gray-600 text-sm">{testimonial.company}</div>
                    </div>
                  </div>

                </div>
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- Navigation Arrows -->
      <div class="absolute inset-y-0 left-0 flex items-center">
        <button 
          id="prevBtn"
          class="bg-white/95 backdrop-blur-sm rounded-full p-3 shadow-lg hover:shadow-xl transition-all duration-300 hover:bg-[#C81F6A] hover:text-white text-gray-700"
          aria-label="Previous testimonial"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M15 19l-7-7 7-7"/>
          </svg>
        </button>
      </div>

      <div class="absolute inset-y-0 right-0 flex items-center">
        <button 
          id="nextBtn"
          class="bg-white/95 backdrop-blur-sm rounded-full p-3 shadow-lg hover:shadow-xl transition-all duration-300 hover:bg-[#C81F6A] hover:text-white text-gray-700"
          aria-label="Next testimonial"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 5l7 7-7 7"/>
          </svg>
        </button>
      </div>

      <!-- Dots Indicator -->
      <div class="flex justify-center gap-3 mt-8">
        {testimonials.map((_, index) => (
          <button
            class="dot w-3 h-3 rounded-full bg-gray-300 hover:bg-[#C81F6A] transition-all duration-300"
            data-index={index}
            aria-label={`Go to testimonial ${index + 1}`}
          />
        ))}
      </div>
    </div>

    <!-- Link to all recommendations -->
    <div class="text-center mt-12">
      <a 
        href="/rekomendacijos" 
        class="inline-flex items-center gap-2 text-[#C81F6A] hover:text-[#A51856] font-semibold text-lg transition-colors duration-300 group"
      >
        Visos rekomendacijos
        <svg class="w-5 h-5 transform group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
        </svg>
      </a>
    </div>
  </div>
</section>

<script>
  // Testimonials carousel functionality
  const track = document.querySelector('.testimonials-track') as HTMLElement;
  const slides = document.querySelectorAll('.testimonial-slide');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const dots = document.querySelectorAll('.dot');
  
  let currentIndex = 0;
  const totalSlides = slides.length;
  
  // Update carousel position
  function updateCarousel() {
    const offset = -currentIndex * 100;
    track.style.transform = `translateX(${offset}%)`;
    
    // Update dots
    dots.forEach((dot, index) => {
      if (index === currentIndex) {
        dot.classList.remove('bg-gray-300');
        dot.classList.add('bg-[#C81F6A]', 'scale-125');
      } else {
        dot.classList.add('bg-gray-300');
        dot.classList.remove('bg-[#C81F6A]', 'scale-125');
      }
    });
  }
  
  // Next slide
  function nextSlide() {
    currentIndex = (currentIndex + 1) % totalSlides;
    updateCarousel();
  }
  
  // Previous slide
  function prevSlide() {
    currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
    updateCarousel();
  }
  
  // Event listeners
  prevBtn?.addEventListener('click', prevSlide);
  nextBtn?.addEventListener('click', nextSlide);
  
  // Dot navigation
  dots.forEach((dot, index) => {
    dot.addEventListener('click', () => {
      currentIndex = index;
      updateCarousel();
    });
  });
  
  // Auto-play (optional)
  let autoplayInterval = setInterval(nextSlide, 5000);
  
  // Pause autoplay on hover
  const container = document.querySelector('.testimonials-container');
  container?.addEventListener('mouseenter', () => {
    clearInterval(autoplayInterval);
  });
  
  container?.addEventListener('mouseleave', () => {
    autoplayInterval = setInterval(nextSlide, 5000);
  });
  
  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') prevSlide();
    if (e.key === 'ArrowRight') nextSlide();
  });
  
  // Touch swipe support
  let touchStartX = 0;
  let touchEndX = 0;
  
  if (container) {
    container.addEventListener('touchstart', (e) => {
      touchStartX = (e as TouchEvent).changedTouches[0].screenX;
    });
    
    container.addEventListener('touchend', (e) => {
      touchEndX = (e as TouchEvent).changedTouches[0].screenX;
      handleSwipe();
    });
  }
  
  function handleSwipe() {
    if (touchEndX < touchStartX - 50) nextSlide();
    if (touchEndX > touchStartX + 50) prevSlide();
  }
  
  // Initialize
  updateCarousel();
</script>

<style>
  .dot.bg-\[\#C81F6A\] {
    background-color: #C81F6A;
  }
  
  /* Smooth transitions */
  .testimonials-track {
    transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* Hover effects */
  button:hover {
    transform: scale(1.05);
  }
  
  /* Focus styles for accessibility */
  button:focus-visible {
    outline: 2px solid #C81F6A;
    outline-offset: 4px;
  }
  
  .dot:focus-visible {
    outline: 2px solid #C81F6A;
    outline-offset: 2px;
  }
</style>
